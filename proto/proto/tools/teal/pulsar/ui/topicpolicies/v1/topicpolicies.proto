syntax = "proto3";

package tools.teal.pulsar.ui.topicpolicies.v1;

import "google/rpc/status.proto";

enum BacklogQuotaRetentionPolicy {
  BACKLOG_QUOTA_RETENTION_POLICY_UNSPECIFIED = 0;
  BACKLOG_QUOTA_RETENTION_POLICY_PRODUCER_REQUEST_HOLD = 1;
  BACKLOG_QUOTA_RETENTION_POLICY_PRODUCER_EXCEPTION = 2;
  BACKLOG_QUOTA_RETENTION_POLICY_CONSUMER_BACKLOG_EVICTION = 3;
}
enum BacklogQuotaType {
  BACKLOG_QUOTA_TYPE_UNSPECIFIED = 0;
  BACKLOG_QUOTA_TYPE_DESTINATION_STORAGE = 1;
  BACKLOG_QUOTA_TYPE_MESSAGE_AGE = 2;
}
message DestinationStorageBacklogQuota {
  int64 limit_size = 1;
  optional BacklogQuotaRetentionPolicy retention_policy = 2;
}
message MessageAgeBacklogQuota {
  int32 limit_time = 1;
  optional BacklogQuotaRetentionPolicy retention_policy = 2;
}
message GetBacklogQuotasRequest {
  string topic = 1;
  bool is_global = 2;
}
message GetBacklogQuotasResponse {
  google.rpc.Status status = 1;
  optional DestinationStorageBacklogQuota destination_storage = 2;
  optional MessageAgeBacklogQuota message_age = 3;
}
message SetBacklogQuotasRequest {
  string topic = 1;
  optional DestinationStorageBacklogQuota destination_storage = 2;
  optional MessageAgeBacklogQuota message_age = 3;
  bool is_global = 4;
}
message SetBacklogQuotasResponse {
  google.rpc.Status status = 1;
}
message RemoveBacklogQuotaRequest {
  string topic = 1;
  BacklogQuotaType backlog_quota_type = 2;
  bool is_global = 3;
}
message RemoveBacklogQuotaResponse {
  google.rpc.Status status = 1;
}

message DelayedDeliveryUnspecified {
}
message DelayedDeliverySpecified {
  bool enabled = 1;
  int64 tick_time_ms = 2;
}
message GetDelayedDeliveryRequest {
  string topic = 1;
  bool is_global = 2;
}
message GetDelayedDeliveryResponse {
  google.rpc.Status status = 1;
  oneof delayed_delivery {
    DelayedDeliveryUnspecified unspecified = 2;
    DelayedDeliverySpecified specified = 3;
  }
}
message SetDelayedDeliveryRequest {
  string topic = 1;
  bool enabled = 2;
  int64 tick_time_ms = 3;
  bool is_global = 4;
}
message SetDelayedDeliveryResponse {
  google.rpc.Status status = 1;
}
message RemoveDelayedDeliveryRequest {
  string topic = 1;
  bool is_global = 2;
}
message RemoveDelayedDeliveryResponse {
  google.rpc.Status status = 1;
}

message MessageTtlUnspecified {}
message MessageTtlSpecified {
  int32 message_ttl_seconds = 1;
}
message GetMessageTtlRequest {
  string topic = 1;
  bool is_global = 2;
}
message GetMessageTtlResponse {
  google.rpc.Status status = 1;
  oneof message_ttl {
    MessageTtlUnspecified unspecified = 2;
    MessageTtlSpecified specified = 3;
  }
}
message SetMessageTtlRequest {
  string topic = 1;
  int32 message_ttl_seconds = 2;
  bool is_global = 3;
}
message SetMessageTtlResponse {
  google.rpc.Status status = 1;
}
message RemoveMessageTtlRequest {
  string topic = 1;
  bool is_global = 2;
}
message RemoveMessageTtlResponse {
  google.rpc.Status status = 1;
}

message RetentionUnspecified {}
message RetentionSpecified {
  int32 retention_time_in_minutes = 1;
  int32 retention_size_in_mb = 2;
}
message GetRetentionRequest {
  string topic = 1;
  bool is_global = 2;
}
message GetRetentionResponse {
  google.rpc.Status status = 1;
  oneof retention {
    RetentionUnspecified unspecified = 3;
    RetentionSpecified specified = 4;
  }
}
message SetRetentionRequest {
  string topic = 1;
  int32 retention_time_in_minutes = 2;
  int32 retention_size_in_mb = 3;
  bool is_global = 4;
}
message SetRetentionResponse {
  google.rpc.Status status = 1;
}
message RemoveRetentionRequest {
  string topic = 1;
  bool is_global = 2;
}
message RemoveRetentionResponse {
  google.rpc.Status status = 1;
}

message MaxUnackedMessagesOnConsumerUnspecified {}
message MaxUnackedMessagesOnConsumerSpecified {
  int32 max_unacked_messages_on_consumer = 1;
}
message GetMaxUnackedMessagesOnConsumerRequest {
  string topic = 1;
  bool is_global = 2;
}
message GetMaxUnackedMessagesOnConsumerResponse {
  google.rpc.Status status = 1;
  oneof max_unacked_messages_on_consumer {
    MaxUnackedMessagesOnConsumerUnspecified unspecified = 2;
    MaxUnackedMessagesOnConsumerSpecified specified = 3;
  }
}
message SetMaxUnackedMessagesOnConsumerRequest {
  string topic = 1;
  int32 max_unacked_messages_on_consumer = 2;
  bool is_global = 3;
}
message SetMaxUnackedMessagesOnConsumerResponse {
  google.rpc.Status status = 1;
}
message RemoveMaxUnackedMessagesOnConsumerRequest {
  string topic = 1;
  bool is_global = 2;
}
message RemoveMaxUnackedMessagesOnConsumerResponse {
  google.rpc.Status status = 1;
}

message MaxUnackedMessagesOnSubscriptionUnspecified {}
message MaxUnackedMessagesOnSubscriptionSpecified {
  int32 max_unacked_messages_on_subscription = 1;
}
message GetMaxUnackedMessagesOnSubscriptionRequest {
  string topic = 1;
  bool is_global = 2;
}
message GetMaxUnackedMessagesOnSubscriptionResponse {
  google.rpc.Status status = 1;
  oneof max_unacked_messages_on_subscription {
    MaxUnackedMessagesOnSubscriptionUnspecified unspecified = 2;
    MaxUnackedMessagesOnSubscriptionSpecified specified = 3;
  }
}
message SetMaxUnackedMessagesOnSubscriptionRequest {
  string topic = 1;
  int32 max_unacked_messages_on_subscription = 2;
  bool is_global = 3;
}
message SetMaxUnackedMessagesOnSubscriptionResponse {
  google.rpc.Status status = 1;
}
message RemoveMaxUnackedMessagesOnSubscriptionRequest {
  string topic = 1;
  bool is_global = 2;
}
message RemoveMaxUnackedMessagesOnSubscriptionResponse {
  google.rpc.Status status = 1;
}

enum InactiveTopicPoliciesDeleteMode {
  INACTIVE_TOPIC_POLICIES_DELETE_MODE_UNSPECIFIED = 0;
  INACTIVE_TOPIC_POLICIES_DELETE_MODE_DELETE_WHEN_NO_SUBSCRIPTIONS = 1;
  INACTIVE_TOPIC_POLICIES_DELETE_MODE_DELETE_WHEN_SUBSCRIPTIONS_CAUGHT_UP = 2;
}
message InactiveTopicPoliciesUnspecified {}
message InactiveTopicPoliciesSpecified {
  InactiveTopicPoliciesDeleteMode inactive_topic_delete_mode = 1;
  int32 max_inactive_duration_seconds = 2;
  bool delete_while_inactive = 3;
}
message GetInactiveTopicPoliciesRequest {
  string topic = 1;
  bool is_global = 2;
}
message GetInactiveTopicPoliciesResponse {
  google.rpc.Status status = 1;
  oneof inactive_topic_policies {
    InactiveTopicPoliciesUnspecified unspecified = 2;
    InactiveTopicPoliciesSpecified specified = 3;
  }
}
message SetInactiveTopicPoliciesRequest {
  string topic = 1;
  InactiveTopicPoliciesDeleteMode inactive_topic_delete_mode = 2;
  int32 max_inactive_duration_seconds = 3;
  bool delete_while_inactive = 4;
  bool is_global = 5;
}
message SetInactiveTopicPoliciesResponse {
  google.rpc.Status status = 1;
}
message RemoveInactiveTopicPoliciesRequest {
  string topic = 1;
  bool is_global = 2;
}
message RemoveInactiveTopicPoliciesResponse {
  google.rpc.Status status = 1;
}

message PersistenceUnspecified {}
message PersistenceSpecified {
  int32 bookkeeper_ensemble = 1;
  int32 bookkeeper_write_quorum = 2;
  int32 bookkeeper_ack_quorum = 3;
  double managed_ledger_max_mark_delete_rate = 4;
}
message GetPersistenceRequest {
  string topic = 1;
  bool is_global = 2;
}
message GetPersistenceResponse {
  google.rpc.Status status = 1;
  oneof persistence {
    PersistenceUnspecified unspecified = 3;
    PersistenceSpecified specified = 4;
  }
}
message SetPersistenceRequest {
  string topic = 1;
  int32 bookkeeper_ensemble = 2;
  int32 bookkeeper_write_quorum = 3;
  int32 bookkeeper_ack_quorum = 4;
  double managed_ledger_max_mark_delete_rate = 5;
  bool is_global = 6;
}
message SetPersistenceResponse {
  google.rpc.Status status = 1;
}
message RemovePersistenceRequest {
  string topic = 1;
  bool is_global = 2;
}
message RemovePersistenceResponse {
  google.rpc.Status status = 1;
}

message DeduplicationUnspecified {
}
message DeduplicationSpecified {
  bool enabled = 1;
}
message GetDeduplicationRequest {
  string topic = 1;
  bool is_global = 2;
}
message GetDeduplicationResponse {
  google.rpc.Status status = 1;
  oneof deduplication {
    DeduplicationUnspecified unspecified = 2;
    DeduplicationSpecified specified = 3;
  }
}
message SetDeduplicationRequest {
  string topic = 1;
  bool enabled = 2;
  bool is_global = 3;
}
message SetDeduplicationResponse {
  google.rpc.Status status = 1;
}
message RemoveDeduplicationRequest {
  string topic = 1;
  bool is_global = 2;
}
message RemoveDeduplicationResponse {
  google.rpc.Status status = 1;
}

message DeduplicationSnapshotIntervalDisabled {
}
message DeduplicationSnapshotIntervalEnabled {
  int32 interval = 1;
}
message GetDeduplicationSnapshotIntervalRequest {
  string topic = 1;
  bool is_global = 2;
}
message GetDeduplicationSnapshotIntervalResponse {
  google.rpc.Status status = 1;
  oneof interval {
    DeduplicationSnapshotIntervalDisabled disabled = 2;
    DeduplicationSnapshotIntervalEnabled enabled = 3;
  }
}
message SetDeduplicationSnapshotIntervalRequest {
  string topic = 1;
  int32 interval = 2;
  bool is_global = 3;
}
message SetDeduplicationSnapshotIntervalResponse {
  google.rpc.Status status = 1;
}
message RemoveDeduplicationSnapshotIntervalRequest {
  string topic = 1;
  bool is_global = 2;
}
message RemoveDeduplicationSnapshotIntervalResponse {
  google.rpc.Status status = 1;
}

message DispatchRateUnspecified {}
message DispatchRateSpecified {
  int32 rate_in_msg = 1;
  int64 rate_in_byte = 2;
  int32 period_in_second = 3;
  bool is_relative_to_publish_rate = 4;
}
message GetDispatchRateRequest {
  string topic = 1;
  bool is_global = 2;
}
message GetDispatchRateResponse {
  google.rpc.Status status = 1;
  oneof dispatch_rate {
    DispatchRateUnspecified unspecified = 2;
    DispatchRateSpecified specified = 3;
  }
}
message SetDispatchRateRequest {
  string topic = 1;
  int32 rate_in_msg = 2;
  int64 rate_in_byte = 3;
  int32 period_in_second = 4;
  bool is_relative_to_publish_rate = 5;
  bool is_global = 6;
}
message SetDispatchRateResponse {
  google.rpc.Status status = 1;
}
message RemoveDispatchRateRequest {
  string topic = 1;
  bool is_global = 2;
}
message RemoveDispatchRateResponse {
  google.rpc.Status status = 1;
}

message ReplicatorDispatchRateUnspecified {}
message ReplicatorDispatchRateSpecified {
  int32 rate_in_msg = 1;
  int64 rate_in_byte = 2;
  bool is_relative_to_publish_rate = 3;
  int32 period_in_second = 4;
}
message GetReplicatorDispatchRateRequest {
  string topic = 1;
  bool is_global = 2;
}
message GetReplicatorDispatchRateResponse {
  google.rpc.Status status = 1;
  oneof replicator_dispatch_rate {
    ReplicatorDispatchRateUnspecified unspecified = 3;
    ReplicatorDispatchRateSpecified specified = 4;
  }
}
message SetReplicatorDispatchRateRequest {
  string topic = 1;
  int32 rate_in_msg = 2;
  int64 rate_in_byte = 3;
  bool is_relative_to_publish_rate = 4;
  int32 period_in_second = 5;
  bool is_global = 6;
}
message SetReplicatorDispatchRateResponse {
  google.rpc.Status status = 1;
}
message RemoveReplicatorDispatchRateRequest {
  string topic = 1;
  bool is_global = 2;
}
message RemoveReplicatorDispatchRateResponse {
  google.rpc.Status status = 1;
}

message SubscriptionDispatchRateUnspecified {}
message SubscriptionDispatchRateSpecified {
  int32 rate_in_msg = 1;
  int64 rate_in_byte = 2;
  bool is_relative_to_publish_rate = 3;
  int32 period_in_second = 4;
}
message GetSubscriptionDispatchRateRequest {
  string topic = 1;
  bool is_global = 2;
}
message GetSubscriptionDispatchRateResponse {
  google.rpc.Status status = 1;
  oneof subscription_dispatch_rate {
    SubscriptionDispatchRateUnspecified unspecified = 3;
    SubscriptionDispatchRateSpecified specified = 4;
  }
}
message SetSubscriptionDispatchRateRequest {
  string topic = 1;
  int32 rate_in_msg = 2;
  int64 rate_in_byte = 3;
  bool is_relative_to_publish_rate = 4;
  int32 period_in_second = 5;
  bool is_global = 6;
}
message SetSubscriptionDispatchRateResponse {
  google.rpc.Status status = 1;
}
message RemoveSubscriptionDispatchRateRequest {
  string topic = 1;
  bool is_global = 2;
}
message RemoveSubscriptionDispatchRateResponse {
  google.rpc.Status status = 1;
}

message CompactionThresholdDisabled {
}
message CompactionThresholdEnabled {
  int64 threshold = 1;
}
message GetCompactionThresholdRequest {
  string topic = 1;
  bool is_global = 2;
}
message GetCompactionThresholdResponse {
  google.rpc.Status status = 1;
  oneof threshold {
    CompactionThresholdDisabled disabled = 2;
    CompactionThresholdEnabled enabled = 3;
  }
}
message SetCompactionThresholdRequest {
  string topic = 1;
  int64 threshold = 2;
  bool is_global = 3;
}
message SetCompactionThresholdResponse {
  google.rpc.Status status = 1;
}
message RemoveCompactionThresholdRequest {
  string topic = 1;
  bool is_global = 2;
}
message RemoveCompactionThresholdResponse {
  google.rpc.Status status = 1;
}

message PublishRateUnspecified {}
message PublishRateSpecified {
  int32 rate_in_msg = 1;
  int64 rate_in_byte = 2;
}
message GetPublishRateRequest {
  string topic = 1;
  bool is_global = 2;
}
message GetPublishRateResponse {
  google.rpc.Status status = 1;
  oneof publish_rate {
    PublishRateUnspecified unspecified = 2;
    PublishRateSpecified specified = 3;
  }
}
message SetPublishRateRequest {
  string topic = 1;
  int32 rate_in_msg = 2;
  int64 rate_in_byte = 3;
  bool is_global = 4;
}
message SetPublishRateResponse {
  google.rpc.Status status = 1;
}
message RemovePublishRateRequest {
  string topic = 1;
  bool is_global = 2;
}
message RemovePublishRateResponse {
  google.rpc.Status status = 1;
}

service TopicpoliciesService {

  rpc GetBacklogQuotas(GetBacklogQuotasRequest) returns (GetBacklogQuotasResponse);
  rpc SetBacklogQuotas(SetBacklogQuotasRequest) returns (SetBacklogQuotasResponse);
  rpc RemoveBacklogQuota(RemoveBacklogQuotaRequest) returns (RemoveBacklogQuotaResponse);

  rpc GetDelayedDelivery(GetDelayedDeliveryRequest) returns (GetDelayedDeliveryResponse);
  rpc SetDelayedDelivery(SetDelayedDeliveryRequest) returns (SetDelayedDeliveryResponse);
  rpc RemoveDelayedDelivery(RemoveDelayedDeliveryRequest) returns (RemoveDelayedDeliveryResponse);

  rpc GetMessageTtl(GetMessageTtlRequest) returns (GetMessageTtlResponse);
  rpc SetMessageTtl(SetMessageTtlRequest) returns (SetMessageTtlResponse);
  rpc RemoveMessageTtl(RemoveMessageTtlRequest) returns (RemoveMessageTtlResponse);

  rpc GetRetention(GetRetentionRequest) returns (GetRetentionResponse);
  rpc SetRetention(SetRetentionRequest) returns (SetRetentionResponse);
  rpc RemoveRetention(RemoveRetentionRequest) returns (RemoveRetentionResponse);

  rpc GetMaxUnackedMessagesOnConsumer(GetMaxUnackedMessagesOnConsumerRequest) returns (GetMaxUnackedMessagesOnConsumerResponse);
  rpc SetMaxUnackedMessagesOnConsumer(SetMaxUnackedMessagesOnConsumerRequest) returns (SetMaxUnackedMessagesOnConsumerResponse);
  rpc RemoveMaxUnackedMessagesOnConsumer(RemoveMaxUnackedMessagesOnConsumerRequest) returns (RemoveMaxUnackedMessagesOnConsumerResponse);

  rpc GetMaxUnackedMessagesOnSubscription(GetMaxUnackedMessagesOnSubscriptionRequest) returns (GetMaxUnackedMessagesOnSubscriptionResponse);
  rpc SetMaxUnackedMessagesOnSubscription(SetMaxUnackedMessagesOnSubscriptionRequest) returns (SetMaxUnackedMessagesOnSubscriptionResponse);
  rpc RemoveMaxUnackedMessagesOnSubscription(RemoveMaxUnackedMessagesOnSubscriptionRequest) returns (RemoveMaxUnackedMessagesOnSubscriptionResponse);
  
  rpc GetInactiveTopicPolicies(GetInactiveTopicPoliciesRequest) returns (GetInactiveTopicPoliciesResponse);
  rpc SetInactiveTopicPolicies(SetInactiveTopicPoliciesRequest) returns (SetInactiveTopicPoliciesResponse);
  rpc RemoveInactiveTopicPolicies(RemoveInactiveTopicPoliciesRequest) returns (RemoveInactiveTopicPoliciesResponse);

  rpc GetPersistence(GetPersistenceRequest) returns (GetPersistenceResponse);
  rpc SetPersistence(SetPersistenceRequest) returns (SetPersistenceResponse);
  rpc RemovePersistence(RemovePersistenceRequest) returns (RemovePersistenceResponse);

  rpc GetDeduplication(GetDeduplicationRequest) returns (GetDeduplicationResponse);
  rpc SetDeduplication(SetDeduplicationRequest) returns (SetDeduplicationResponse);
  rpc RemoveDeduplication(RemoveDeduplicationRequest) returns (RemoveDeduplicationResponse);

  rpc GetDeduplicationSnapshotInterval(GetDeduplicationSnapshotIntervalRequest) returns (GetDeduplicationSnapshotIntervalResponse);
  rpc SetDeduplicationSnapshotInterval(SetDeduplicationSnapshotIntervalRequest) returns (SetDeduplicationSnapshotIntervalResponse);
  rpc RemoveDeduplicationSnapshotInterval(RemoveDeduplicationSnapshotIntervalRequest) returns (RemoveDeduplicationSnapshotIntervalResponse);

  rpc GetDispatchRate(GetDispatchRateRequest) returns (GetDispatchRateResponse);
  rpc SetDispatchRate(SetDispatchRateRequest) returns (SetDispatchRateResponse);
  rpc RemoveDispatchRate(RemoveDispatchRateRequest) returns (RemoveDispatchRateResponse);

  rpc GetReplicatorDispatchRate(GetReplicatorDispatchRateRequest) returns (GetReplicatorDispatchRateResponse);
  rpc SetReplicatorDispatchRate(SetReplicatorDispatchRateRequest) returns (SetReplicatorDispatchRateResponse);
  rpc RemoveReplicatorDispatchRate(RemoveReplicatorDispatchRateRequest) returns (RemoveReplicatorDispatchRateResponse);

  rpc GetSubscriptionDispatchRate(GetSubscriptionDispatchRateRequest) returns (GetSubscriptionDispatchRateResponse);
  rpc SetSubscriptionDispatchRate(SetSubscriptionDispatchRateRequest) returns (SetSubscriptionDispatchRateResponse);
  rpc RemoveSubscriptionDispatchRate(RemoveSubscriptionDispatchRateRequest) returns (RemoveSubscriptionDispatchRateResponse);

  rpc GetCompactionThreshold(GetCompactionThresholdRequest) returns (GetCompactionThresholdResponse);
  rpc SetCompactionThreshold(SetCompactionThresholdRequest) returns (SetCompactionThresholdResponse);
  rpc RemoveCompactionThreshold(RemoveCompactionThresholdRequest) returns (RemoveCompactionThresholdResponse);

  rpc GetPublishRate(GetPublishRateRequest) returns (GetPublishRateResponse);
  rpc SetPublishRate(SetPublishRateRequest) returns (SetPublishRateResponse);
  rpc RemovePublishRate(RemovePublishRateRequest) returns (RemovePublishRateResponse);
}